### 线性规划问题
1.求解下列线性规划问题：
$$
\begin{aligned}
\max & \quad z = 3x_1 - x_2 - x_3 \\\\
s.t. & \quad x_1 - 2x_2 + x_3 \leq 11 \\\\
& \quad -4x_1 + x_2 + 2x_3 \geq 3 \\\\
& \quad -2x_1 + x_3 = 1 \\\\
& \quad x_1, x_2, x_3 \geq 0
\end{aligned}
$$

使用 `linprog` 函数求解，得到最优解为：

$$
\begin{cases}
x_1 &= 4 \\\\
x_2 &= 1 \\\\
x_3 &= 9 \\\\
z &= 2
\end{cases}
$$

---

2.求解下列线性规划问题：
$$
\begin{aligned}
\min & \quad z = |x_1| + 2|x_2| + 3|x_3| + 4|x_4| \\\\
s.t. & \quad x_1 - x_2 - x_3 + x_4 = 0 \\\\
& \quad x_1 - x_2 + x_3 - 3x_4 = 1 \\\\
& \quad x_1 - x_2 - 2x_3 +3x_4 = -\frac{1}{2} \\\\
\end{aligned}
$$

做变量替换 $u_i = \frac{x_i+|x_i|}{2}, v_i = \frac{x_i-|x_i|}{2}, i=1,2,3,4$，记 $u=[u_1, u_2, u_3, u_4]^T, v=[v_1, v_2, v_3, v_4]^T$，则原问题可以转化为：

$$
\begin{aligned}
\min & \quad z = c^T(u+v) \\\\
s.t. & \quad Au = b \\\\
& \quad u, v \geq 0  
\end{aligned}
$$

其中 $c = [1, 2, 3, 4]^T, A = \begin{bmatrix} 1 & -1 & -1 & 1 \\\\ 1 & -1 & 1 & -3 \\\\ 1 & -1 & -2 & 3 \end{bmatrix}, b = [0, 1, -\frac{1}{2}]^T$

然后使用 `linprog` 函数求解，得到最优解为：

$$
\begin{cases}
x_1 &= 0.25 \\\\
x_2 &= 0 \\\\
x_3 &= 0 \\\\
x_4 &= -0.25 \\\\
z &= 1.25
\end{cases}
$$

---
3.一架货机有三个货舱：前舱、中仓和后舱。该货机三个货舱所能装载的货物最大质量和体积有均限制，如表1所示。<br>为了维持飞机平衡，三个货舱装载的货物之类必须与其最大容许量成比例。

表1 货舱数据 <br>

|             | 前舱  | 中仓  | 后舱  |
| :---------: | :---: | :---: | :---: |
| 质量限制/t  |  10   |  16   |   8   |
| 体积限制/m³ | 6800  | 8700  | 5300  |


现有四类货物用于装载，其质量和体积以及装运后的利润如表2所示。

表2 货物数据 <br>

| 货物  | 质量/t | 体积/m³ | 利润/(元/t) |
| :---: | :----: | :-----: | :---------: |
| 货物1 |   18   |   480   |    3100     |
| 货物2 |   15   |   650   |    3800     |
| 货物3 |   23   |   580   |    3500     |
| 货物4 |   12   |   390   |    2850     |

假设：
- 每种货物可以无限细分；
- 每种货物可以分布在一个或多个货舱中；
- 不同货物可以放在同一个货舱中，并且保证不留空间；
  
应该如何安排货物的装载，才能使得飞机的利润最大？

为了便于计算，使用如下定义：<br>
$x_{ij}$ 表示货物 $i$ 在货舱 $j$ 中的装载质量（吨），其中 $i\in{1,2,3,4}$，$j\in\{前舱(1),中舱(2),后舱(3)\}$;
用 $p_i$ 表示货物 $i$ 的单位利润（元/吨）, $v_i$ 表示货物 $i$ 的体积（m³）.

那么目标函数可以表示为：

$$

\max \quad z = \sum_{i=1}^{4}\sum_{j=1}^{3}x_{ij}p_i \tag{1}
$$

接下来分别表示质量和体积的约束条件。<br>质量约束，即四种货物的总质量不超过每部分的承载质量，表示为：

$$
\begin{cases}
\sum_{i=1}^{4}x_{i1} \leq 10, \\\\
\sum_{i=1}^{4}x_{i2} \leq 16, \\\\
\sum_{i=1}^{4}x_{i3} \leq 8,
\end{cases} \tag{2}
$$

货物的总体积约束表示为：

$$
\begin{cases}
\sum_{i=1}^{4}x_{i1}v_i \leq 6800, \\\\
\sum_{i=1}^{4}x_{i2}v_i \leq 8700, \\\\
\sum_{i=1}^{4}x_{i3}v_i \leq 5300,
\end{cases} \tag{3}
$$

还需要添加比例的约束条件，即货舱中的货物质量与体积的比例应该相同。假设比例系数 $\lambda$，可以表示为两个等式约束：

$$
\begin{cases}
M_1 = \sum_{i=1}^{4}x_{i1} = 10\lambda, \\\\
M_2 = \sum_{i=1}^{4}x_{i2} = 16\lambda, \\\\ 
M_3 = \sum_{i=1}^{4}x_{i3} = 8\lambda,
\end{cases}\Rightarrow 
\begin{cases}
16M_1 - 10M_2 = 0, \\\\
8M_2 - 16M_3 = 0,
\end{cases}
\tag{4}
$$

最后，还需要添加每个货品自身的上限数量约束：

$$
\begin{cases}
\sum_{j=1}^{3}x_{1j} \leq 18, \\\\
\sum_{j=1}^{3}x_{2j} \leq 15, \\\\
\sum_{j=1}^{3}x_{3j} \leq 23, \\\\
\sum_{j=1}^{3}x_{4j} \leq 12,
\end{cases} \tag{5}
$$

最终，将目标函数和约束条件输入 `linprog` 函数求解，得到最优装配方案为：



| | 前舱 | 中仓 | 后舱 |
| :---: | :---: | :---: | :---: |
| 货物1 | 0 | 0 | 0 |
| 货物2 | 10 | 0 | 5 |
| 货物3 | 0 | 12.9474 | 3 |
| 货物4 | 0 | 3.0526 | 0 |



此时，飞机的最大利润为  $z = 121515.79$.